"use strict";(self.webpackChunkio_github_lyrihkaesa=self.webpackChunkio_github_lyrihkaesa||[]).push([["6498"],{19534:function(e,a,n){n.r(a),n.d(a,{default:()=>o,frontMatter:()=>l,metadata:()=>s,assets:()=>t,toc:()=>c,contentTitle:()=>d});var s=JSON.parse('{"id":"deploy-vps","title":"Deploy VPS","description":"Ini adalah catatan singkat mengenai masalah/issue yang ada pada saat deploy ke VPS:","source":"@site/articles/laravel/23-deploy-vps.md","sourceDirName":".","slug":"/deploy-vps","permalink":"/laravel/deploy-vps","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":23,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Laravel Filesystem local storage temporaryUrl()","permalink":"/laravel/laravel-filesystem-local-temporary-url"},"next":{"title":"Action Event Queue Job","permalink":"/laravel/action-event-queue-job"}}'),r=n("85893"),i=n("50065");let l={},d="Deploy VPS",t={},c=[{value:"HTTP &amp; HTTPS",id:"http--https",level:2},{value:"CORS",id:"cors",level:2},{value:"Permission Storage",id:"permission-storage",level:2},{value:"Container Persistent Storage Symlink ke Dir HOST",id:"container-persistent-storage-symlink-ke-dir-host",level:2},{value:"Reverse Proxy",id:"reverse-proxy",level:2},{value:"Deploy",id:"deploy",level:2},{value:"Create VPS (Virtual Private Server)",id:"create-vps-virtual-private-server",level:3},{value:"Pantangan Saat Deploy Ke Server Linux",id:"pantangan-saat-deploy-ke-server-linux",level:3},{value:"Login ke VPS dengan SSH",id:"login-ke-vps-dengan-ssh",level:3},{value:"Menambahkan User (Opsional)",id:"menambahkan-user-opsional",level:3},{value:"Mengatur SSH",id:"mengatur-ssh",level:3},{value:"Generate SSH Key",id:"generate-ssh-key",level:3},{value:"Mematikan kemampuan login ssh dengan root user",id:"mematikan-kemampuan-login-ssh-dengan-root-user",level:3},{value:"Membuat alias login ssh",id:"membuat-alias-login-ssh",level:3},{value:"Install <code>php</code>",id:"install-php",level:3}];function h(e){let a={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"deploy-vps",children:"Deploy VPS"})}),"\n",(0,r.jsx)(a.p,{children:"Ini adalah catatan singkat mengenai masalah/issue yang ada pada saat deploy ke VPS:"}),"\n",(0,r.jsx)(a.h2,{id:"http--https",children:"HTTP & HTTPS"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:(0,r.jsx)(a.code,{children:"app\\Providers\\AppServiceProvider.php"})}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-php",children:"\\Illuminate\\Support\\Facades\\URL::forceScheme('https');\n"})}),"\n",(0,r.jsx)(a.h2,{id:"cors",children:"CORS"}),"\n",(0,r.jsx)(a.h2,{id:"permission-storage",children:"Permission Storage"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo chown -R $USER:www-data storage\r\nsudo chown -R $USER:www-data bootstrap/cache\r\nsudo chmod -R 775 storage\r\nsudo chmod -R 775 bootstrap/cache\n"})}),"\n",(0,r.jsx)(a.h2,{id:"container-persistent-storage-symlink-ke-dir-host",children:"Container Persistent Storage Symlink ke Dir HOST"}),"\n",(0,r.jsx)(a.h2,{id:"reverse-proxy",children:"Reverse Proxy"}),"\n",(0,r.jsx)(a.h2,{id:"deploy",children:"Deploy"}),"\n",(0,r.jsx)(a.h3,{id:"create-vps-virtual-private-server",children:"Create VPS (Virtual Private Server)"}),"\n",(0,r.jsxs)(a.p,{children:["Untuk latihan anda bisa menggunakan layanan sewa VPS (Virtual Private Server) yang pembayarannya hanya saat digunakan bukan bulanan atau tahunan melainkan bayar per jam, istilah lainnya itu ",(0,r.jsx)(a.code,{children:"pay as you go"}),". Contoh saja ",(0,r.jsx)(a.code,{children:"IDCouldHost"})," Anda dapat membantu saya dengan menggunakan:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Referral link: ",(0,r.jsx)(a.a,{href:"https://console.idcloudhost.com/referral/4k86mh",children:"https://console.idcloudhost.com/referral/4k86mh"})]}),"\n",(0,r.jsx)(a.li,{children:"Referral code:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-txt",children:"4k86mh\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Pada tanggal 25 Januari 2025 Top Up minimal pada ",(0,r.jsx)(a.code,{children:"IDCouldHost"})," adalah Rp55.000 + Rp6.050 ",(0,r.jsx)(a.code,{children:"PPN 11%"})," = Rp61.050 + Rp2.000 ",(0,r.jsx)(a.code,{children:"admin dari e-wallet saya"})," = Rp63.050 ",(0,r.jsx)(a.code,{children:"Total"}),".\r\nJadi siapkan saja uang sekitar Rp65.000 untuk belajar."]}),"\n",(0,r.jsxs)(a.p,{children:["Jika sudah mari kita buat VPS. Spekfikasi VPS bebas yang penting menggunakan OS (Operating System) ",(0,r.jsx)(a.code,{children:"Ubuntu"}),". Karena panduan saya menggunakan OS Ubuntu. Saya sarankan pada server gunakanlah OS seri ",(0,r.jsx)(a.code,{children:"Long Term Support (LTS)"})," karena lebih lama dalam support atau perawatan OS tersebut. Misal saya menggunakan ",(0,r.jsx)(a.code,{children:"Ubuntu 24.04 LTS"}),"."]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Tentang VPS IDCouldhost yang saya maksud:"})}),"\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Apa yang terjadi jika VPS-nya dimatikan (shutdown)?"}),(0,r.jsx)(a.br,{}),"\n","Jawaban: Anda hanya menyewa storage disk/hdd saja 20GB = Rp12.000"]}),"\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Apa yang terjadi jika VPS-nya dihapus?"}),(0,r.jsx)(a.br,{}),"\n","Jawaban: Yaa, Anda tidak keluar biaya lagi, jadi bisa disimpan buat latihan nanti."]}),"\n",(0,r.jsx)(a.h3,{id:"pantangan-saat-deploy-ke-server-linux",children:"Pantangan Saat Deploy Ke Server Linux"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Jangan gunakan ",(0,r.jsx)(a.code,{children:"root"})," user untuk login SSH dengan password, kalau bisa gunakan user biasa dan gunakan SSH key."]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"login-ke-vps-dengan-ssh",children:"Login ke VPS dengan SSH"}),"\n",(0,r.jsx)(a.p,{children:"Contoh:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["IP yang didapatkan dari VPS: ",(0,r.jsx)(a.code,{children:"100.100.100.100"})]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Login SSH root user"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"ssh root@100.100.100.100\n"})}),"\n",(0,r.jsx)(a.p,{children:"Jika muncul pertanyaan:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"Are you sure you want to continue connecting (yes/no/[fingerprint])? yes\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Ketik ",(0,r.jsx)(a.code,{children:"yes"})," lalu ",(0,r.jsx)(a.code,{children:"enter"}),". Nanti anda akan diminta masukan password dari user tersebut misal user ",(0,r.jsx)(a.code,{children:"root"}),"."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"root@100.100.100.100's password:\n"})}),"\n",(0,r.jsx)(a.p,{children:"Ketik password lalu enter. Catatan: password tidak tampil demi keamanan jadi saat ketik sebenarnya tulisannya masuk hanya saja di sembunyikan."}),"\n",(0,r.jsx)(a.p,{children:"Jangan lupa update OS:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt update\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt upgrade -y\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Jika tidak menggunakan ",(0,r.jsx)(a.code,{children:"-y"})," anda harus ketik ",(0,r.jsx)(a.code,{children:"y"})," lalu ",(0,r.jsx)(a.code,{children:"enter"}),". Karena perlu konfirmasi."]}),"\n",(0,r.jsx)(a.h3,{id:"menambahkan-user-opsional",children:"Menambahkan User (Opsional)"}),"\n",(0,r.jsxs)(a.p,{children:["Menambahkan user baru untuk login ke OS Ubuntu diperlukan demi keamanan karena user ",(0,r.jsx)(a.code,{children:"root"})," itu terlalu OP (Over Power) jadi kita harus membuat user lain. Biasanya saat membuat VPS auto dibuatkan user jadi ini sifatnya opsional jika sudah dibuatkan oleh penyedia layanan VPS."]}),"\n",(0,r.jsxs)(a.p,{children:["Perintah di bawah ini dalam mode user ",(0,r.jsx)(a.code,{children:"root@ubuntu:~#"})]}),"\n",(0,r.jsx)(a.p,{children:"Membuat user baru:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"adduser kaesa\n"})}),"\n",(0,r.jsx)(a.p,{children:"Masukan password, etc."}),"\n",(0,r.jsxs)(a.p,{children:["Memodifikasi user dengan menambahkan user ",(0,r.jsx)(a.code,{children:"kaesa"})," ke dalam grup ",(0,r.jsx)(a.code,{children:"sudo"})]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"usermod -aG sudo kaesa\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Ganti user ",(0,r.jsx)(a.code,{children:"root"})," ke user ",(0,r.jsx)(a.code,{children:"kaesa"}),". 'switch user'"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"su - kaesa\n"})}),"\n",(0,r.jsx)(a.h3,{id:"mengatur-ssh",children:"Mengatur SSH"}),"\n",(0,r.jsxs)(a.p,{children:["Login dengan user ",(0,r.jsx)(a.code,{children:"kaesa"})]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"ssh kaesa@100.100.100.100\n"})}),"\n",(0,r.jsx)(a.h3,{id:"generate-ssh-key",children:"Generate SSH Key"}),"\n",(0,r.jsx)(a.p,{children:"Pertama buka terminal/git bash pada laptop, lalu jalankan perintah dibawah:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"cd ~/.ssh\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:'ssh-keygen -t rsa -b 2048 -C "idcouldhost.com/kaesa-ubuntu"\n'})}),"\n",(0,r.jsx)(a.p,{children:"Saya biasanya mengubah nama file key SSH:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"Generating public/private rsa key pair.\r\nEnter file in which to save the key (/c/Users/kaesa/.ssh/id_rsa): id_rsa_kaesa\n"})}),"\n",(0,r.jsx)(a.p,{children:"Anda bisa menambahkan passphrase untuk keamanan tambahan."}),"\n",(0,r.jsx)(a.p,{children:"Nanti akan dibuatkan dua file:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"id_rsa_kaesa"})," (Private SSH Key)"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"id_rsa_kaesa.pub"})," (Public SSH Key)"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Melihat isi file dan directory dengan perintah:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"ll\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Copy ",(0,r.jsx)(a.code,{children:"Public SSH Key"})," ke server"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"ssh-copy-id kaesa@100.100.100.100\n"})}),"\n",(0,r.jsx)(a.h3,{id:"mematikan-kemampuan-login-ssh-dengan-root-user",children:"Mematikan kemampuan login ssh dengan root user"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo nano /etc/ssh/sshd_config\n"})}),"\n",(0,r.jsx)(a.p,{children:"Cari:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sshd_config",children:"PremitRootLogin no # Default: yes\r\n\r\nPubkeyAuthentication yes # Default: commented/disabled ada pagar '#' didepan\r\n\r\nAuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2 # Default: commented/disabled\r\n\r\nPasswordAuthentication no # Default: commented/disabled dan yes\r\nPermitEmptyPasswords no # Default: commented/disabled\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo systemctl restart ssh\n"})}),"\n",(0,r.jsx)(a.h3,{id:"membuat-alias-login-ssh",children:"Membuat alias login ssh"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"cd ~/.ssh\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo nano config\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-config",children:"Host kaesa\r\n   User kaesa\r\n   Hostname 100.100.100.100\r\n   Port 22\r\n   IdentityFile ~/.ssh/id_rsa_kaesa\n"})}),"\n",(0,r.jsx)(a.p,{children:"Cara cepat login ke server:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"ssh kaesa\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Perintah di atas itu quick login dari ",(0,r.jsx)(a.code,{children:"ssh kaesa@100.100.100.100 -p 22 -i ~/.ssh/id_rsa_kaesa"})]}),"\n",(0,r.jsxs)(a.h3,{id:"install-php",children:["Install ",(0,r.jsx)(a.code,{children:"php"})]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo add-apt-repository ppa:ondrej/php -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3 php8.3-cli -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3-common php8.3-bcmath php8.3-mbstring php8.3-xml php8.3-curl php8.3-gd php8.3-zip -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3-fpm php8.3-opcache php8.3-imap php8.3-intl php8.3-readline php8.3-soap -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3-mysql -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3-pgsql -y\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"sudo apt install php8.3-sqlite3\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"php -v\n"})})]})}function o(e={}){let{wrapper:a}={...(0,i.a)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},50065:function(e,a,n){n.d(a,{Z:function(){return d},a:function(){return l}});var s=n(67294);let r={},i=s.createContext(r);function l(e){let a=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:a},e.children)}}}]);