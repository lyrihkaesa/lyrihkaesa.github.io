"use strict";(self.webpackChunkio_github_lyrihkaesa=self.webpackChunkio_github_lyrihkaesa||[]).push([["2770"],{46666:function(e,n,a){a.r(n),a.d(n,{default:()=>m,frontMatter:()=>c,metadata:()=>s,assets:()=>t,toc:()=>o,contentTitle:()=>l});var s=JSON.parse('{"id":"devops/submission-3","title":"Submission 3: Proyek Implementasi Asynchronous Communication pada Aplikasi E-Commerce App","description":"\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F","source":"@site/articles/dicoding/devops/032-submission-3.md","sourceDirName":"devops","slug":"/devops/submission-3","permalink":"/dicoding/devops/submission-3","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":32,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Submission 2: Proyek Deploy Aplikasi Karsa Jobs dengan Kubernetes","permalink":"/dicoding/devops/submission-2"},"next":{"title":"istio and istioctl","permalink":"/dicoding/devops/istio"}}'),i=a("85893"),r=a("50065");let c={},l="Submission 3: Proyek Implementasi Asynchronous Communication pada Aplikasi E-Commerce App",t={},o=[{value:"Menambahkan submodule",id:"menambahkan-submodule",level:2},{value:"Reset <code>minikube</code> dan pemasangan <code>istio</code>",id:"reset-minikube-dan-pemasangan-istio",level:2},{value:"Menambahkan RabbitMQ ke Kubernetes dengan <code>helm</code>",id:"menambahkan-rabbitmq-ke-kubernetes-dengan-helm",level:2},{value:"Menambahkan <code>istio</code>",id:"menambahkan-istio",level:2}];function d(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"submission-3-proyek-implementasi-asynchronous-communication-pada-aplikasi-e-commerce-app",children:"Submission 3: Proyek Implementasi Asynchronous Communication pada Aplikasi E-Commerce App"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F\uD83C\uDF1F"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"menambahkan-submodule",children:"Menambahkan submodule"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git submodule add -b order-service https://github.com/lyrihkaesa/a433-microservices.git order-service\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git submodule add -b shipping-service https://github.com/lyrihkaesa/a433-microservices.git shipping-service\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"reset-minikube-dan-pemasangan-istio",children:["Reset ",(0,i.jsx)(n.code,{children:"minikube"})," dan pemasangan ",(0,i.jsx)(n.code,{children:"istio"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"minikube stop\r\nminikube delete\r\nminikube start\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"istioctl install --set profile=demo -y\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl create namespace ecommerce\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl label namespace ecommerce istio-injection=enabled\n"})}),"\n",(0,i.jsx)(n.p,{children:"atau default"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl label namespace default istio-injection=enabled\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"menambahkan-rabbitmq-ke-kubernetes-dengan-helm",children:["Menambahkan RabbitMQ ke Kubernetes dengan ",(0,i.jsx)(n.code,{children:"helm"})]}),"\n",(0,i.jsx)(n.p,{children:"Menambahkan repo ke helm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo add bitnami https://charts.bitnami.com/bitnami\n"})}),"\n",(0,i.jsx)(n.p,{children:"Jangan lupa perbarui repo"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo update\n"})}),"\n",(0,i.jsx)(n.p,{children:"Cek repo-nya sudah ada belum:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo list\n"})}),"\n",(0,i.jsx)(n.p,{children:"Pasang RabbitMQ dengan namespace ecommerce:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install rabbit --set service.type=NodePort bitnami/rabbitmq --namespace ecommerce\n"})}),"\n",(0,i.jsxs)(n.p,{children:["username dari RabbitMQ adalah ",(0,i.jsx)(n.code,{children:"user"}),"\r\nDapatkan password RabbitMQ dengan perintah berikut:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo $(kubectl get secret --namespace ecommerce rabbit-rabbitmq -o jsonpath="{.data.rabbitmq-password}" | base64 -d)\n'})}),"\n",(0,i.jsx)(n.p,{children:"Membuat object kubernetes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f kubernetes/shipping/shipping-service.yaml -n ecommerce\r\nkubectl apply -f kubernetes/shipping/shipping-deployment.yaml -n ecommerce\r\n\r\nkubectl apply -f kubernetes/order/order-service.yaml -n ecommerce\r\nkubectl apply -f kubernetes/order/order-deployment.yaml -n ecommerce\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get all -n ecommerce\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get all -n ecommerce -o wide\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"menambahkan-istio",children:["Menambahkan ",(0,i.jsx)(n.code,{children:"istio"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f kubernetes/istio/ecommerce-gateway.yaml -n ecommerce\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export INGRESS_HOST=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].ip}')\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name==\"http2\")].port}')\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export SECURE_INGRESS_PORT=$(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name==\"https\")].port}')\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo "$INGRESS_HOST" "$INGRESS_PORT" "$SECURE_INGRESS_PORT"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export GATEWAY_URL=$INGRESS_HOST:$INGRESS_PORT\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo "http://$GATEWAY_URL/order"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get statefulset.apps/rabbit-rabbitmq -o yaml -n ecommerce\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"minikube tunnel\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"POST"})," http:127.0.0.1/order dengan body:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n\xa0 \xa0\xa0"order":\xa0{\r\n\xa0 \xa0 \xa0 \xa0\xa0"book_name":\xa0"Harry\xa0Potter",\r\n\xa0 \xa0 \xa0 \xa0\xa0"author":\xa0"J.K\xa0Rowling",\r\n\xa0 \xa0 \xa0 \xa0\xa0"buyer":\xa0"Fikri\xa0Helmi\xa0Setiawan",\r\n\xa0 \xa0 \xa0 \xa0\xa0"shipping_address":\xa0"Jl.\xa0Batik\xa0Kumeli\xa0no\xa050\xa0Bandung"\r\n\xa0 \xa0\xa0}\r\n}\n'})})]})}function m(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},50065:function(e,n,a){a.d(n,{Z:function(){return l},a:function(){return c}});var s=a(67294);let i={},r=s.createContext(i);function c(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);